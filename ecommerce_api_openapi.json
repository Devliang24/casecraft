{"openapi":"3.1.0","info":{"title":"E-commerce API Core Edition","description":"轻量化电商API - 17个核心接口","version":"1.0.0"},"paths":{"/health":{"get":{"summary":"Health Check","description":"Health check endpoint with unified response format","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint with API information","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/test-error":{"get":{"summary":"Test Error","description":"Test error response","operationId":"test_error_test_error_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/auth/register":{"post":{"tags":["Authentication"],"summary":"Register","description":"Register a new user.\n\n- **username**: unique username\n- **email**: unique email address\n- **password**: password (will be hashed)\n- **full_name**: optional full name\n- **shipping_address**: optional shipping address\n\nReturns the created user (without password).","operationId":"register_api_v1_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Register Api V1 Auth Register Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/login":{"post":{"tags":["Authentication"],"summary":"Login","description":"用户登录接口\n\n使用用户名和密码进行登录，返回用户信息。\n注意：本系统使用HTTP Basic Auth，实际认证通过请求头进行。\n\n- **username**: 用户名\n- **password**: 密码\n\nReturns user information if login successful.","operationId":"login_api_v1_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserLogin"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Login Api V1 Auth Login Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/session":{"delete":{"tags":["Authentication"],"summary":"Logout","description":"用户登出接口\n\nHTTP Basic Auth无需服务端状态，客户端直接清除认证信息即可。","operationId":"logout_api_v1_auth_session_delete","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Logout Api V1 Auth Session Delete"}}}}}}},"/api/v1/users/me":{"get":{"tags":["Users"],"summary":"Get Current User Info","description":"Get current user information.\n\nAccessible by: User, Admin","operationId":"get_current_user_info_api_v1_users_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Get Current User Info Api V1 Users Me Get"}}}}},"security":[{"HTTPBasic":[]}]},"put":{"tags":["Users"],"summary":"Update Current User","description":"Update current user information.\n\nAccessible by: User, Admin\n\n- **username**: new username (must be unique)\n- **email**: new email (must be unique)\n- **full_name**: new full name\n- **shipping_address**: new shipping address","operationId":"update_current_user_api_v1_users_me_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Update Current User Api V1 Users Me Put"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBasic":[]}]}},"/api/v1/categories/":{"get":{"tags":["Categories"],"summary":"Get All Categories","description":"Get all categories.\n\nAccessible by: Public (no authentication required)\n\nReturns all categories ordered by name.\nThis endpoint is typically used for dropdown menus and navigation.","operationId":"get_all_categories_api_v1_categories__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"tags":["Categories"],"summary":"Create Category","description":"Create a new category.\n\nAccessible by: Admin only\n\n- **name**: unique category name\n- **description**: optional category description","operationId":"create_category_api_v1_categories__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CategoryCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBasic":[]}]}},"/api/v1/categories/{category_id}":{"get":{"tags":["Categories"],"summary":"Get Category By Id","description":"Get category by ID.\n\nAccessible by: Public (no authentication required)","operationId":"get_category_by_id_api_v1_categories__category_id__get","parameters":[{"name":"category_id","in":"path","required":true,"schema":{"type":"integer","title":"Category Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/products/":{"post":{"tags":["Products"],"summary":"Create Product","description":"Create a new product.\n\nAccessible by: Admin only\n\n- **name**: product name\n- **description**: product description\n- **price**: product price (must be positive)\n- **stock**: initial stock quantity\n- **category_id**: ID of the category this product belongs to","operationId":"create_product_api_v1_products__post","security":[{"HTTPBasic":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Products"],"summary":"Get Products","description":"Get products with advanced filtering and pagination.\n\nAccessible by: Public (no authentication required)\n\nQuery parameters:\n- **skip**: Number of products to skip (pagination)\n- **limit**: Number of products to return (max 100)\n- **category_id**: Filter by specific category\n- **min_price**: Minimum price filter\n- **max_price**: Maximum price filter\n- **in_stock**: Filter by stock availability (true/false)\n- **search**: Search in product name and description\n- **sort_by**: Field to sort by (name, price, created_at, stock)\n- **sort_order**: Sort order (asc or desc)","operationId":"get_products_api_v1_products__get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Number of products to skip","default":0,"title":"Skip"},"description":"Number of products to skip"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Number of products to return","default":20,"title":"Limit"},"description":"Number of products to return"},{"name":"category_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Filter by category ID","title":"Category Id"},"description":"Filter by category ID"},{"name":"min_price","in":"query","required":false,"schema":{"anyOf":[{"type":"number","minimum":0},{"type":"null"}],"description":"Minimum price filter","title":"Min Price"},"description":"Minimum price filter"},{"name":"max_price","in":"query","required":false,"schema":{"anyOf":[{"type":"number","minimum":0},{"type":"null"}],"description":"Maximum price filter","title":"Max Price"},"description":"Maximum price filter"},{"name":"in_stock","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"description":"Filter by stock availability","title":"In Stock"},"description":"Filter by stock availability"},{"name":"search","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search in product name and description","title":"Search"},"description":"Search in product name and description"},{"name":"sort_by","in":"query","required":false,"schema":{"type":"string","description":"Field to sort by","default":"created_at","title":"Sort By"},"description":"Field to sort by"},{"name":"sort_order","in":"query","required":false,"schema":{"type":"string","pattern":"^(asc|desc)$","description":"Sort order","default":"desc","title":"Sort Order"},"description":"Sort order"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/products/{product_id}":{"get":{"tags":["Products"],"summary":"Get Product By Id","description":"Get product by ID with category information.\n\nAccessible by: Public (no authentication required)\n\nThis endpoint is heavily cached for performance.","operationId":"get_product_by_id_api_v1_products__product_id__get","parameters":[{"name":"product_id","in":"path","required":true,"schema":{"type":"integer","title":"Product Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/cart/":{"get":{"tags":["Shopping Cart"],"summary":"Get Cart","description":"Get the current user's shopping cart.\n\nAccessible by: User, Admin\n\nReturns the cart with all items, including product details and calculated totals.","operationId":"get_cart_api_v1_cart__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Cart"}}}}},"security":[{"HTTPBasic":[]}]}},"/api/v1/cart/items":{"post":{"tags":["Shopping Cart"],"summary":"Add Item To Cart","description":"Add an item to the shopping cart.\n\nAccessible by: User, Admin\n\n- **product_id**: ID of the product to add\n- **quantity**: quantity to add (must be positive)\n\nIf the item already exists in cart, the quantities will be added together.","operationId":"add_item_to_cart_api_v1_cart_items_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CartItemCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Cart"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBasic":[]}]}},"/api/v1/cart/items/{product_id}":{"delete":{"tags":["Shopping Cart"],"summary":"Remove Item From Cart","description":"Remove an item from the shopping cart.\n\nAccessible by: User, Admin","operationId":"remove_item_from_cart_api_v1_cart_items__product_id__delete","security":[{"HTTPBasic":[]}],"parameters":[{"name":"product_id","in":"path","required":true,"schema":{"type":"integer","title":"Product Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Cart"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Shopping Cart"],"summary":"Update Item Quantity","description":"Update item quantity in the shopping cart.\n\nAccessible by: User, Admin\n\n- **quantity**: new quantity (must be positive)\n\nIf quantity is 0, the item will be removed from cart.","operationId":"update_item_quantity_api_v1_cart_items__product_id__put","security":[{"HTTPBasic":[]}],"parameters":[{"name":"product_id","in":"path","required":true,"schema":{"type":"integer","title":"Product Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CartItemUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Cart"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orders/":{"post":{"tags":["Orders"],"summary":"Create Order","description":"Create a new order from cart items.\n\nAccessible by: User, Admin\n\n- **shipping_address**: delivery address for the order\n\nThis endpoint performs the complete checkout process:\n1. Validates cart items\n2. Checks inventory availability\n3. Creates order with items\n4. Decreases product stock\n5. Clears the cart\n\nReturns order details or error information.","operationId":"create_order_api_v1_orders__post","security":[{"HTTPBasic":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CheckoutRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Orders"],"summary":"Get Orders","description":"Get orders based on user role and scope.\n\nAccessible by: User (own orders), Admin (own or all orders)\n\nQuery parameters:\n- **skip**: Number of orders to skip (pagination)\n- **limit**: Number of orders to return (max 100)\n- **status**: Filter by order status (pending, confirmed, shipped, delivered, cancelled)\n- **sort_by**: Field to sort by (created_at, total_price, status)\n- **sort_order**: Sort order (asc or desc)\n- **scope**: 'user' for own orders, 'all' for all orders (admin only)","operationId":"get_orders_api_v1_orders__get","security":[{"HTTPBasic":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Number of orders to skip","default":0,"title":"Skip"},"description":"Number of orders to skip"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Number of orders to return","default":20,"title":"Limit"},"description":"Number of orders to return"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by order status","title":"Status"},"description":"Filter by order status"},{"name":"sort_by","in":"query","required":false,"schema":{"type":"string","description":"Field to sort by","default":"created_at","title":"Sort By"},"description":"Field to sort by"},{"name":"sort_order","in":"query","required":false,"schema":{"type":"string","pattern":"^(asc|desc)$","description":"Sort order","default":"desc","title":"Sort Order"},"description":"Sort order"},{"name":"scope","in":"query","required":false,"schema":{"type":"string","pattern":"^(user|all)$","description":"Order scope: 'user' for own orders, 'all' for all orders (admin only)","default":"user","title":"Scope"},"description":"Order scope: 'user' for own orders, 'all' for all orders (admin only)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orders/{order_id}":{"get":{"tags":["Orders"],"summary":"Get Order By Id","description":"Get order details by ID.\n\nAccessible by: User (own orders), Admin (any order)","operationId":"get_order_by_id_api_v1_orders__order_id__get","security":[{"HTTPBasic":[]}],"parameters":[{"name":"order_id","in":"path","required":true,"schema":{"type":"integer","title":"Order Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/debug/info":{"get":{"summary":"Debug Info","description":"Debug information (development only)","operationId":"debug_info_debug_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Cart":{"properties":{"owner_id":{"type":"integer","title":"Owner Id"},"items":{"items":{"$ref":"#/components/schemas/CartItem"},"type":"array","title":"Items","default":[]},"total_price":{"type":"number","title":"Total Price","default":0.0},"total_items":{"type":"integer","title":"Total Items","default":0}},"type":"object","required":["owner_id"],"title":"Cart"},"CartItem":{"properties":{"product_id":{"type":"integer","title":"Product Id"},"quantity":{"type":"integer","title":"Quantity"},"product":{"anyOf":[{"$ref":"#/components/schemas/Product"},{"type":"null"}]},"subtotal":{"type":"number","title":"Subtotal"}},"type":"object","required":["product_id","quantity","subtotal"],"title":"CartItem"},"CartItemCreate":{"properties":{"product_id":{"type":"integer","title":"Product Id"},"quantity":{"type":"integer","title":"Quantity"}},"type":"object","required":["product_id","quantity"],"title":"CartItemCreate"},"CartItemUpdate":{"properties":{"quantity":{"type":"integer","title":"Quantity"}},"type":"object","required":["quantity"],"title":"CartItemUpdate"},"Category":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"id":{"type":"integer","title":"Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["name","id","created_at","updated_at"],"title":"Category"},"CategoryCreate":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"}},"type":"object","required":["name"],"title":"CategoryCreate"},"CheckoutRequest":{"properties":{"shipping_address":{"type":"string","title":"Shipping Address"}},"type":"object","required":["shipping_address"],"title":"CheckoutRequest"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Product":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"price":{"type":"number","title":"Price"},"stock":{"type":"integer","title":"Stock"},"category_id":{"type":"integer","title":"Category Id"},"id":{"type":"integer","title":"Id"},"is_active":{"type":"boolean","title":"Is Active"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"category":{"anyOf":[{"$ref":"#/components/schemas/Category"},{"type":"null"}]}},"type":"object","required":["name","price","stock","category_id","id","is_active","created_at","updated_at"],"title":"Product"},"ProductCreate":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"price":{"type":"number","title":"Price"},"stock":{"type":"integer","title":"Stock"},"category_id":{"type":"integer","title":"Category Id"}},"type":"object","required":["name","price","stock","category_id"],"title":"ProductCreate"},"UserCreate":{"properties":{"username":{"type":"string","title":"Username"},"email":{"type":"string","format":"email","title":"Email"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"shipping_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Shipping Address"},"password":{"type":"string","title":"Password"},"role":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Role","default":"user"}},"type":"object","required":["username","email","password"],"title":"UserCreate"},"UserLogin":{"properties":{"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"}},"type":"object","required":["username","password"],"title":"UserLogin"},"UserUpdate":{"properties":{"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"shipping_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Shipping Address"}},"type":"object","title":"UserUpdate"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBasic":{"type":"http","scheme":"basic","description":"HTTP Basic Authentication (username:password)"}}}}